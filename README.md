# –≤—Å–µ–º –ø—Ä–∏–≤ —ç—Ç–æ —Ç–∏–ø–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è, –µ—Å–ª–∏ —á–µ—Ç–æ –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ –ø–∏—à–∏—Ç–µ, –±—É–¥—É —Å—Ç–∞—Ä–∞—Ç—å—Å—è –æ–±—ä—è–Ω–∏—Ç—å —á–µ –∫ —á–µ–º—É
#—Å–æ—Ä–∏ –≥—Ä–∞—Ñ–∏–∫–∏ –º–æ–≥—É—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å—Å—è –∏–ª–∏ —Ç–∞–º –º–± –∫–∞–∫–∏–µ-—Ç–æ –Ω–µ –æ—á –ø–æ–Ω—è—Ç–Ω—ã–µ —è —ç—Ç–æ –ø–æ—á–∏—â—É, –º–Ω–µ —ç—Ç–æ —Å–∫–æ—Ä–µ–µ –≤ –æ—Ç—á–µ—Ç–µ –Ω–∞–¥–æ –±—É–¥–µ—Ç, –Ω–æ –ø–æ–∑–∂–µ
# —Ñ–∞–π–ª—ã standartized_rating.csv –∏ processed_tags.csv - –≤–µ—Å—è—Ç –æ—á–µ–Ω—å –º–Ω–æ–≥–æ, –ø–æ—ç—Ç–æ–º—É —è –æ—Ç–ø—Ä–∞–≤–∏–ª–∞ –∏—Ö –≤ —Ç–µ–ª–µ–≥–µ, –µ—Å–ª–∏ —á—Ç–æ –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –ª–µ–∂–∞—Ç—å –≤ –ø–∞–ø–∫–µ output –≤ –¥–∞–Ω–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ

–û—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã —Ä–∞–±–æ—Ç—ã 
1- –û—á–∏—Å—Ç–∫–∞ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
–§–∞–π–ª—ã:
cleaned_movies.csv ‚Üí –æ—á–∏—â–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ñ–∏–ª—å–º–æ–≤
cleaned_tags.csv ‚Üí –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ–≥–∏
cleaned_ratings.csv ‚Üí –æ—á–∏—â–µ–Ω–Ω—ã–µ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
–§–∞–π–ª—ã —á–∏—Ç–∞—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é pandas.read_csv().
dtype_dict = {"userId": "uint32", "movieId": "uint32", "rating": "float32", "timestamp": "int32"}

tags_df = pd.read_csv("output/cleaned_tags.csv", usecols=["movieId", "tag"])
movies_df = pd.read_csv("output/cleaned_movies.csv", usecols=["movieId", "title", "genres"])
ratings_df = pd.read_csv("output/cleaned_ratings.csv", dtype=dtype_dict)

–±—ã–ª–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:
uint32 (–±–µ–∑–∑–Ω–∞–∫–æ–≤–æ–µ 32-–±–∏—Ç–Ω–æ–µ —á–∏—Å–ª–æ) —É–º–µ–Ω—å—à–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å int64.
float32 –∑–∞–Ω–∏–º–∞–µ—Ç –≤ 2 —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏, —á–µ–º float64.
–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–ª–µ–∑–Ω–∞, –µ—Å–ª–∏ –¥–∞—Ç–∞—Å–µ—Ç –æ—á–µ–Ω—å –±–æ–ª—å—à–æ–π (–º–∏–ª–ª–∏–æ–Ω—ã –∑–∞–ø–∏—Å–µ–π).
–ö–∞–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–µ–ª–∞—é—Ç—Å—è?

dropna() ‚Üí —É–¥–∞–ª—è–µ—Ç NaN (–ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è).
drop_duplicates() ‚Üí —É–±–∏—Ä–∞–µ—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —Å—Ç—Ä–æ–∫–∏.
astype(str).str.split('|') ‚Üí —Ä–∞–∑–±–∏–µ–Ω–∏–µ —Ç–µ–≥–æ–≤ –ø–æ |, —Ç–∞–∫ –∫–∞–∫ –æ–¥–∏–Ω —Ñ–∏–ª—å–º –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ–≥–æ–≤.
2Ô∏è‚É£ –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –æ—Ü–µ–Ω–æ–∫
–ê–ª–≥–æ—Ä–∏—Ç–º KMeans —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ —Ä–∞–∑–ª–∏—á–Ω—ã–º –º–∞—Å—à—Ç–∞–±–∞–º –¥–∞–Ω–Ω—ã—Ö. –ï—Å–ª–∏ —Ä–µ–π—Ç–∏–Ω–≥–∏ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [1, 5], –∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ü–µ–Ω–æ–∫ –≤ [10,000, 500,000], —Ç–æ –±–æ–ª—å—à–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏ —Ä–∞—Å—á—ë—Ç–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤.

–ü–æ—ç—Ç–æ–º—É –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ:

def standardize_data(df, column):
    df[column] = (df[column] - df[column].mean()) / df[column].std()
    return df
‚Äã
 
–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:

MinMax Scaling ‚Üí –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω [0,1], –Ω–æ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∫ –≤—ã–±—Ä–æ—Å–∞–º.
Robust Scaling ‚Üí –º–µ–Ω–µ–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –≤—ã–±—Ä–æ—Å–∞–º, –Ω–æ —Ç–µ—Ä—è–µ—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Å—à—Ç–∞–±—ã –¥–∞–Ω–Ω—ã—Ö.
3- –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏
–ß—Ç–æ–±—ã –∞–ª–≥–æ—Ä–∏—Ç–º –º–æ–≥ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–∏–µ —Ñ–∏–ª—å–º—ã –ø–æ—Ö–æ–∂–∏, –∫–∞–∂–¥–æ–º—É —Ñ–∏–ª—å–º—É –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (—Ñ–∏—á–∏).
def create_movie_features(movies_df, ratings_df, tags_df):
    # One-Hot Encoding –∂–∞–Ω—Ä–æ–≤
    genres_encoded = movies_df['genres'].str.get_dummies('|')

    # –°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ —Ñ–∏–ª—å–º–∞
    avg_ratings = ratings_df.groupby('movieId')['rating'].mean().rename('avg_rating')

    # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ü–µ–Ω–æ–∫ —Ñ–∏–ª—å–º–∞
    rating_counts = ratings_df.groupby('movieId')['rating'].count().rename('rating_count')

    # –û–±—ä–µ–¥–∏–Ω—è–µ–º —Ñ–∏—á–∏
    features = movies_df.set_index('movieId').join([genres_encoded, avg_ratings, rating_counts])

    # –ó–∞–ø–æ–ª–Ω—è–µ–º NaN –Ω—É–ª—è–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —É —Ñ–∏–ª—å–º–∞ –Ω–µ—Ç —Ä–µ–π—Ç–∏–Ω–≥–∞)
    return features.fillna(0)

–ñ–∞–Ω—Ä—ã ‚Üí –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –≤ One-Hot Encoding (get_dummies()).
–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ ‚Üí groupby().mean().
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ü–µ–Ω–æ–∫ ‚Üí groupby().count().
–ü–æ—á–µ–º—É –≤–∞–∂–µ–Ω One-Hot Encoding?
KMeans —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —á–∏—Å–ª–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏, –ø–æ—ç—Ç–æ–º—É —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (Action|Sci-Fi) –Ω—É–∂–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ –±–∏–Ω–∞—Ä–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã:

nginx
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
Action | Sci-Fi | Comedy
   1   |   1    |   0
–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:

TF-IDF –¥–ª—è —Ç–µ–≥–æ–≤, –µ—Å–ª–∏ –±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è.
Word2Vec/Embeddings –¥–ª—è –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∂–∞–Ω—Ä–æ–≤.
4Ô∏è- –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è —Ñ–∏–ª—å–º–æ–≤
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º KMeans, –Ω–æ –≤ –≤–∞—Ä–∏–∞–Ω—Ç–µ MiniBatchKMeans.
from sklearn.cluster import MiniBatchKMeans

def train_kmeans(movies_df, n_clusters=10):
    features = movies_df.drop(columns=['title', 'genres'])  # –£–±–∏—Ä–∞–µ–º –Ω–µ—á–∏—Å–ª–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
    kmeans = MiniBatchKMeans(n_clusters=n_clusters, batch_size=1000, random_state=42)
    movies_df['cluster'] = kmeans.fit_predict(features)
    return kmeans, movies_df
    
MiniBatchKMeans –æ–±–Ω–æ–≤–ª—è–µ—Ç –∫–ª–∞—Å—Ç–µ—Ä—ã –ø–æ—Ä—Ü–∏—è–º–∏ –ø–æ 1000 –∑–∞–ø–∏—Å–µ–π (—é–∑–∞–µ—Ç –º–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏).
–†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–º–Ω–æ–≥–æ –±—ã—Å—Ç—Ä–µ–µ –Ω–∞ –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö.
–ö–∞—á–µ—Å—Ç–≤–æ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫–æ–µ –∂–µ, –∫–∞–∫ —É –æ–±—ã—á–Ω–æ–≥–æ KMeans.
–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:

DBSCAN (–¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π —Ñ–æ—Ä–º—ã, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥–±–æ—Ä–∞ eps).
Agglomerative Clustering (–∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω—ã–π).
5Ô∏è- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
–ü–æ—Å–ª–µ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä–æ—è—Ç—Å—è –≥—Ä–∞—Ñ–∏–∫–∏.
def plot_cluster_distribution(movies_df):
    import matplotlib.pyplot as plt
    movies_df['cluster'].value_counts().sort_index().plot(kind='bar')
    plt.xlabel("–ö–ª–∞—Å—Ç–µ—Ä—ã")
    plt.ylabel("–ß–∏—Å–ª–æ —Ñ–∏–ª—å–º–æ–≤")
    plt.title("–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ–∏–ª—å–º–æ–≤ –ø–æ –∫–ª–∞—Å—Ç–µ—Ä–∞–º")
    plt.show()
Bar Chart ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ —Ñ–∏–ª—å–º–æ–≤ –≤ –∫–∞–∂–¥–æ–º –∫–ª–∞—Å—Ç–µ—Ä–µ.
Scatter Plot (–µ—Å–ª–∏ –º–Ω–æ–≥–æ —Ñ–∏—á–µ–π) ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è PCA –∏–ª–∏ TSNE –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏.
6Ô∏è-  –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –ø–æ –∫–ª–∞—Å—Ç–µ—Ä–∞–º
–ü–æ—Å–ª–µ —Ä–∞–∑–±–∏–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º:

–ö–∞–∫–∏–µ –∂–∞–Ω—Ä—ã –ø—Ä–µ–æ–±–ª–∞–¥–∞—é—Ç –≤ –∫–∞–∂–¥–æ–º –∫–ª–∞—Å—Ç–µ—Ä–µ?
–ö–∞–∫–æ–π —Å—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ —Ñ–∏–ª—å–º–æ–≤ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ?
def analyze_genres_by_cluster(movies_df):
    return movies_df.groupby('cluster')['genres'].apply(lambda x: x.value_counts().head(5))
.groupby('cluster') ‚Üí –≥—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –∫–ª–∞—Å—Ç–µ—Ä—É.
.apply(lambda x: x.value_counts().head(5)) ‚Üí –∏—â–µ–º —Ç–æ–ø-5 –∂–∞–Ω—Ä–æ–≤ –≤ –∫–∞–∂–¥–æ–º –∫–ª–∞—Å—Ç–µ—Ä–µ.
7Ô∏è - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Ñ–∏–ª—å–º–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
–ï—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –æ—Ü–µ–Ω–æ–∫ –≤ –æ–¥–Ω–æ–º –∫–ª–∞—Å—Ç–µ—Ä–µ, –æ–Ω, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –ª—é–±–∏—Ç —Ç–∞–∫–∏–µ —Ñ–∏–ª—å–º—ã.
def get_favorite_cluster(user_id, ratings_df, movies_df):
    user_ratings = ratings_df[ratings_df['userId'] == user_id]
    user_movies = user_ratings.merge(movies_df, on="movieId")
    return user_movies['cluster'].value_counts().idxmax()
–ë–µ—Ä—ë–º –æ—Ü–µ–Ω–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
–û–ø—Ä–µ–¥–µ–ª—è–µ–º, –≤ –∫–∞–∫–∏—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö –Ω–∞—Ö–æ–¥—è—Ç—Å—è —ç—Ç–∏ —Ñ–∏–ª—å–º—ã.
–í—ã–±–∏—Ä–∞–µ–º —Å–∞–º—ã–π —á–∞—Å—Ç—ã–π –∫–ª–∞—Å—Ç–µ—Ä ‚Üí —ç—Ç–æ –ª—é–±–∏–º—ã–π —Ç–∏–ø —Ñ–∏–ª—å–º–æ–≤.
8Ô∏è- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
movies_df.to_csv('output/clusters_movies.csv', index=False)
–¢–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–æ–¥–µ–ª—å KMeans:
import joblib
joblib.dump(kmeans, 'output/kmeans_model.pkl')

–ß—Ç–æ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ?
 –ß–∏—Å—Ç–∫–∞ –∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
 –ê–Ω–∞–ª–∏–∑ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
 –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ (MiniBatchKMeans)
 –ê–Ω–∞–ª–∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ (–∂–∞–Ω—Ä—ã, —Ä–µ–π—Ç–∏–Ω–≥–∏, –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å)
 –í—ã–¥–µ–ª–µ–Ω–∏–µ –ª—é–±–∏–º–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
 –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±–∞–∑–æ–≤—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
 –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤


—á—Ç–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–Ω—Ç gpt (–≤–∏–¥–∏–º–æ –¥–ª—è –î–∞—à–∏ –∑–∞–¥–∞—á–∫–∏ –∏—Å—Ö–æ–¥—è –∏–∑ –Ω–∞—à–µ–≥–æ —Ä–∞–∑–±–∏–µ–Ω–∏—è —Ä–æ–ª–µ–π)
–°–∏—Å—Ç–µ–º–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å FastAPI –¥–ª—è REST API
–ü–æ–¥–∫–ª—é—á–∏—Ç—å PostgreSQL / ClickHouse –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é)
–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ (—Å–∂–∞—Ç–∏–µ, joblib vs ONNX)

–î–ª—è –ú–∞—à–∏ –µ—â–µ —Ä–∞–∑, –±–æ–ª–µ–µ —Ü–µ–ª–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å —Ç–µ–±–µ –∫–∞–∫ –º—ã —Å gpt —ç—Ç–æ –ø–æ–Ω—è–ª–∏))
–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –±—ç–∫–µ–Ω–¥-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞: –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –±—ç–∫–µ–Ω–¥-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ä–∞–∑–≤–∏–≤–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É —Ñ–∏–ª—å–º–æ–≤. –ó–¥–µ—Å—å –ø–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—Å–∞–Ω–æ, –≥–¥–µ –±—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, –∫–∞–∫ –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ —á—Ç–æ –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è API.

1Ô∏è–î–∞–Ω–Ω—ã–µ: –ì–¥–µ —á—Ç–æ –ª–µ–∂–∏—Ç –∏ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
–í—Å—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞, –ø–æ—ç—Ç–æ–º—É –±—Ä–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –Ω—É–∂–Ω–æ –∏–∑ output/:

–§–∞–π–ª	–ß—Ç–æ —Å–æ–¥–µ—Ä–∂–∏—Ç	–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
cleaned_movies.csv	ID —Ñ–∏–ª—å–º–∞, –Ω–∞–∑–≤–∞–Ω–∏–µ, –∂–∞–Ω—Ä—ã	–ü–æ–¥–≥—Ä—É–∂–∞—Ç—å –º–µ—Ç–∞-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∏–ª—å–º–∞—Ö
cleaned_tags.csv	ID —Ñ–∏–ª—å–º–∞, —Ç–µ–≥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π	–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–º–∞—Ç–∏–∫—É —Ñ–∏–ª—å–º–æ–≤
cleaned_ratings.csv	ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, ID —Ñ–∏–ª—å–º–∞, —Ä–µ–π—Ç–∏–Ω–≥	–î–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ü–µ–Ω–æ–∫
clusters_movies.csv	ID —Ñ–∏–ª—å–º–∞, –Ω–∞–∑–≤–∞–Ω–∏–µ, –∫–ª–∞—Å—Ç–µ—Ä	–û–ø—Ä–µ–¥–µ–ª—è—Ç—å, –≤ –∫–∞–∫–æ–º –∫–ª–∞—Å—Ç–µ—Ä–µ —Ñ–∏–ª—å–º
kmeans_model.pkl	–û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å KMeans	–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–æ–≤—ã—Ö —Ñ–∏–ª—å–º–æ–≤
2Ô∏è - –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ API (FastAPI)
–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ API.
–ò—Å–ø–æ–ª—å–∑—É–µ–º FastAPI ‚Äì –æ–Ω –±—ã—Å—Ç—Ä—ã–π, –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∏ –ª–µ–≥–∫–æ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è.

 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install fastapi uvicorn joblib pandas numpy
 –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ API
from fastapi import FastAPI
import pandas as pd
import joblib

app = FastAPI()

# –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
movies_df = pd.read_csv("output/clusters_movies.csv")
kmeans = joblib.load("output/kmeans_model.pkl")

@app.get("/")
def home():
    return {"message": "Recommender System API is running"}

–¢–µ–ø–µ—Ä—å API –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∫–æ–º–∞–Ω–¥–æ–π:
uvicorn main:app --host 0.0.0.0 --port 8000
3Ô∏è -  –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—Å–Ω–æ–≤–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

1. –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∏–ª—å–º–µ
–≠—Ç–æ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∏–ª—å–º–µ –ø–æ ID.
@app.get("/movie/{movie_id}")
def get_movie(movie_id: int):
    movie = movies_df[movies_df["movieId"] == movie_id]
    if movie.empty:
        return {"error": "Movie not found"}
    return movie.to_dict(orient="records")[0]
–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:
GET http://localhost:8000/movie/1

üìå –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:
{
  "movieId": 1,
  "title": "Toy Story (1995)",
  "genres": "Animation|Children|Comedy",
  "cluster": 3
}
2-  –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ñ–∏–ª—å–º—É
@app.get("/recommend/movie/{movie_id}")
def recommend_movies(movie_id: int, n: int = 5):
    movie = movies_df[movies_df["movieId"] == movie_id]
    if movie.empty:
        return {"error": "Movie not found"}
    
    cluster = movie["cluster"].values[0]
    recommendations = movies_df[movies_df["cluster"] == cluster].sample(n)
    return recommendations[["movieId", "title"]].to_dict(orient="records")
–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:
GET http://localhost:8000/recommend/movie/1?n=5
 –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:
[
  {"movieId": 45, "title": "Casablanca (1942)"},
  {"movieId": 67, "title": "Citizen Kane (1941)"},
  {"movieId": 128, "title": "Schindler's List (1993)"},
  {"movieId": 255, "title": "Pulp Fiction (1994)"},
  {"movieId": 302, "title": "Forrest Gump (1994)"}
]
3. –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
–≠—Ç–æ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç, –∫–∞–∫–∏–µ –∫–ª–∞—Å—Ç–µ—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–º–æ—Ç—Ä–µ–ª —á–∞—â–µ –≤—Å–µ–≥–æ, –∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç —Ñ–∏–ª—å–º—ã –æ—Ç—Ç—É–¥–∞.
ratings_df = pd.read_csv("output/cleaned_ratings.csv")

@app.get("/recommend/user/{user_id}")
def recommend_for_user(user_id: int, n: int = 5):
    user_ratings = ratings_df[ratings_df["userId"] == user_id]
    if user_ratings.empty:
        return {"error": "User not found"}
    
    top_cluster = user_ratings.merge(movies_df, on="movieId")["cluster"].value_counts().idxmax()
    recommendations = movies_df[movies_df["cluster"] == top_cluster].sample(n)
    
    return recommendations[["movieId", "title"]].to_dict(orient="records")
 –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:
GET http://localhost:8000/recommend/user/5?n=5

 –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:
[
  {"movieId": 90, "title": "The Matrix (1999)"},
  {"movieId": 128, "title": "Inception (2010)"},
  {"movieId": 215, "title": "Interstellar (2014)"},
  {"movieId": 312, "title": "The Dark Knight (2008)"},
  {"movieId": 499, "title": "Fight Club (1999)"}
]


 –ò—Ç–æ–≥–∏
–ì–¥–µ –±—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ?

clusters_movies.csv ‚Üí –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
kmeans_model.pkl ‚Üí –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
cleaned_ratings.csv ‚Üí –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
–ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ API?

/movie/{movie_id} ‚Üí –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ–∏–ª—å–º–µ
/recommend/movie/{movie_id} ‚Üí –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ñ–∏–ª—å–º—É
/recommend/user/{user_id} ‚Üí –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
–ö–∞–∫ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å?

FastAPI + Uvicorn
Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
–ì–æ—Ç–æ–≤–æ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ —Å–µ—Ä–≤–∏—Å!

